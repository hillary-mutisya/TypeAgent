<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>M365 Chat - TypeAgent</title>
    <link rel="stylesheet" href="../vendor/bootstrap/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />
    <link rel="stylesheet" href="m365Chat.css" />
  </head>
  <body>
    <div class="m365-chat-container">
      <!-- Header -->
      <div class="chat-header">
        <div class="header-content">
          <h4>
            <i class="bi bi-chat-dots"></i>
            M365 Copilot Chat
          </h4>
          <button id="refreshButton" class="btn btn-sm btn-outline-secondary">
            <i class="bi bi-arrow-clockwise"></i>
          </button>
        </div>
        <div class="connection-status">
          <span class="status-indicator status-connected"></span>
          <small>Connected</small>
        </div>
      </div>

      <!-- M365 Chat IFrame -->
      <div class="chat-iframe-container">
        <iframe
          id="m365ChatFrame"
          src=""
          sandbox="allow-same-origin allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox allow-top-navigation allow-top-navigation-by-user-activation allow-downloads"
          allow="clipboard-read; clipboard-write"
        ></iframe>
      </div>

      <!-- Loading Indicator -->
      <div id="loadingIndicator" class="loading-overlay">
        <div class="spinner-border"></div>
        <p>Loading M365 Chat...</p>
      </div>

      <!-- Error Display -->
      <div id="errorDisplay" class="error-overlay" style="display:none;">
        <div class="error-content">
          <i class="bi bi-exclamation-triangle"></i>
          <h5>Failed to Load M365 Chat</h5>
          <p id="errorMessage"></p>
          <button id="retryButton" class="btn btn-primary">Retry</button>
        </div>
      </div>
    </div>

    <script src="../vendor/bootstrap/bootstrap.bundle.min.js"></script>
    <script src="m365Chat.js"></script>
  </body>
</html>
